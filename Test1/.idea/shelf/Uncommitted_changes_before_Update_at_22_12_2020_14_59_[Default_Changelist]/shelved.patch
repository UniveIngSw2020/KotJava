Index: app/src/main/java/com/example/test1/MapsActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.test1;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.core.app.ActivityCompat;\r\nimport androidx.fragment.app.FragmentActivity;\r\n\r\nimport android.Manifest;\r\nimport android.content.pm.PackageManager;\r\nimport android.location.Address;\r\nimport android.location.Geocoder;\r\nimport android.location.Location;\r\nimport android.os.Bundle;\r\nimport android.view.Menu;\r\nimport android.view.MenuInflater;\r\nimport android.view.MenuItem;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.ImageButton;\r\nimport android.widget.SearchView;\r\nimport android.widget.Toast;\r\nimport android.widget.Toolbar;\r\n\r\n//Menu inferiore Metodo 2\r\n//import android.widget.Toolbar.OnMenuItemClickListener;\r\n//Menu inferiore Metodo 3\r\nimport android.view.MenuItem.OnMenuItemClickListener;\r\n\r\nimport com.google.android.gms.maps.CameraUpdate;\r\nimport com.google.android.gms.maps.CameraUpdateFactory;\r\nimport com.google.android.gms.maps.GoogleMap;\r\nimport com.google.android.gms.maps.OnMapReadyCallback;\r\nimport com.google.android.gms.maps.SupportMapFragment;\r\nimport com.google.android.gms.maps.model.LatLng;\r\nimport com.google.android.gms.maps.model.MarkerOptions;\r\nimport com.google.android.gms.location.FusedLocationProviderClient;\r\nimport com.google.android.gms.location.LocationServices;\r\nimport com.google.android.gms.tasks.OnSuccessListener;\r\nimport com.google.android.gms.tasks.Task;\r\n\r\nimport java.io.IOException;\r\nimport java.util.List;\r\n\r\npublic class MapsActivity extends FragmentActivity implements OnMapReadyCallback, GoogleMap.OnMyLocationButtonClickListener, GoogleMap.OnMyLocationClickListener {\r\n    private ImageButton bfav;\r\n    private ImageButton bstats;\r\n    private ImageButton bloc;\r\n    private ImageButton bhist;\r\n\r\n    private FusedLocationProviderClient fusedLocationClient;\r\n    private GoogleMap map;\r\n    SearchView searchView;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n\r\n\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_maps);\r\n        fusedLocationClient = LocationServices.getFusedLocationProviderClient(this);\r\n\r\n        //Toolbar superiore con l'overflow menu\r\n        Toolbar myToolbar1 = (Toolbar) findViewById(R.id.toolbar);\r\n        setActionBar(myToolbar1);\r\n        getActionBar().setDisplayShowTitleEnabled(false);\r\n\r\n        //Menu inferiore: Metodo 1\r\n         //(+)Più semplice degli altri metodi\r\n         //(+)Si ha tutto in un solo luogo\r\n         //(-)Quel luogo è la oncreate\r\n         //(-)I bottoni non compaiono\r\n/*        ImageButton bfav = findViewById(R.id.imageButtonFavourites);\r\n        bfav.setOnClickListener(new View.OnClickListener(){\r\n            public void onClick(View v){\r\n                //cose\r\n            }\r\n        });\r\n        ImageButton bstats = findViewById(R.id.imageButtonStats);\r\n        ImageButton bloc = findViewById(R.id.imageButtonLocation);\r\n        ImageButton bhist = findViewById(R.id.imageButtonHistory);\r\n*/\r\n\r\n\r\n\r\n\r\n        //Menu inferiore: Metodo 2\r\n         //(+ 0 -?)Permette di avere le azioni al click divise dalle altre\r\n         //(+)Permette di avere tutte le operazioni in un posto\r\n         //(-)Quel posto è la oncreate\r\n         //(-)Non mostra le icone\r\n        /*\r\n        Toolbar myToolbar2 = (Toolbar) findViewById(R.id.toolbar2);\r\n        myToolbar2.inflateMenu(R.menu.menu_maps_2);\r\n        myToolbar2.setOnMenuItemClickListener(new OnMenuItemClickListener() {\r\n            @Override//!!!Con sta roba c'è il secondo menu ma non è con le icone!!!\r\n            public boolean onMenuItemClick(MenuItem item) {\r\n                switch (item.getItemId()) {\r\n                    case R.id.favourites:\r\n                        //cose\r\n                        return true;\r\n                    case R.id.stats:\r\n                        //cose\r\n                        return true;\r\n                    case R.id.location:\r\n                        //cose\r\n                        return true;\r\n                    case R.id.history:\r\n                        //cose\r\n                        return true;\r\n                    default:\r\n                        return false;\r\n                }\r\n            }\r\n        });*/\r\n\r\n\r\n        searchView = findViewById(R.id.srclocation);\r\n        SupportMapFragment mapFragment = (SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map);\r\n\r\n       searchView.setOnQueryTextListener(new SearchView.OnQueryTextListener() {\r\n            @Override\r\n            public boolean onQueryTextSubmit(String query) {\r\n                String location = searchView.getQuery().toString();\r\n                List<Address> addressList = null;\r\n                System.out.println(location);\r\n                if(location != null  && !location.equals(\"\")){\r\n                    System.out.println(\"dentro if\");\r\n                    Geocoder geocoder = new Geocoder(getApplicationContext());\r\n                    try{\r\n\r\n                        addressList = geocoder.getFromLocationName(location, 1);\r\n                        System.out.println(addressList);\r\n                    } catch (IOException e) {\r\n                        e.printStackTrace();\r\n                    }\r\n                    /*\r\n                    Address address = addressList.get(0);\r\n                    LatLng latLng = new LatLng(address.getLatitude(),address.getLongitude());\r\n                    System.out.println(address);\r\n                    map.addMarker(new MarkerOptions().position(latLng).title(location));\r\n                    map.animateCamera(CameraUpdateFactory.newLatLngZoom(latLng,10));\r\n\r\n                     */\r\n                }\r\n                return false;\r\n            }\r\n\r\n            @Override\r\n            public boolean onQueryTextChange(String newText) {\r\n                return false;\r\n            }\r\n        });\r\n\r\n\r\n        mapFragment.getMapAsync(this);\r\n    }\r\n\r\n\r\n    /**\r\n     * Manipulates the map once available.\r\n     * This callback is triggered when the map is ready to be used.\r\n     * This is where we can add markers or lines, add listeners or move the camera. In this case,\r\n     * we just add a marker near Sydney, Australia.\r\n     * If Google Play services is not installed on the device, the user will be prompted to install\r\n     * it inside the SupportMapFragment. This method will only be triggered once the user has\r\n     * installed Google Play services and returned to the app.\r\n     */\r\n    @Override\r\n    public void onMapReady(GoogleMap map) {\r\n        if (FirstAccessActivity.checkPermission(getApplicationContext())) {\r\n            System.out.println(\"entrato\");\r\n\r\n            map.setMyLocationEnabled(true);\r\n            map.setOnMyLocationButtonClickListener(this);\r\n            map.setOnMyLocationClickListener(this);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void onMyLocationClick(@NonNull Location location) {\r\n        Toast.makeText(this, \"Current location:\\n\" + location, Toast.LENGTH_LONG)\r\n                .show();\r\n    }\r\n\r\n    @Override\r\n    public boolean onMyLocationButtonClick() {\r\n        Toast.makeText(this, \"MyLocation button clicked\", Toast.LENGTH_SHORT)\r\n                .show();\r\n\r\n        return false;\r\n    }\r\n\r\n    //Creazione del menu della maps activity\r\n    @Override\r\n    public boolean onCreateOptionsMenu(Menu menu) {\r\n        getMenuInflater().inflate(R.menu.menu_maps, menu);\r\n\r\n        //Menu inferiore: Metodo 3\r\n         //(+)Permette di avere la creazione del secondo menu insieme a quella del primo\r\n         //(+)Permette di aggiungere le opzioni del menu2 a quelle del menu1 per la gestione\r\n         //(+)Permette di non dover settare i listener nella oncreate\r\n         //(-)Non mostra le icone come dovrebbe\r\n        /**/\r\n        Toolbar myToolbar2 = (Toolbar) findViewById(R.id.toolbar2);\r\n        Menu menu2 = myToolbar2.getMenu();\r\n        getMenuInflater().inflate(R.menu.menu_maps_2, menu2);\r\n        for(int i= 0; i < menu2.size(); i++){\r\n            menu2.getItem(i).setOnMenuItemClickListener(new OnMenuItemClickListener(){\r\n                @Override\r\n                public boolean onMenuItemClick(MenuItem item){\r\n                    return onOptionsItemSelected(item);\r\n                }\r\n            });\r\n        }\r\n        return true;\r\n    }\r\n\r\n    //Gestione del click sulle varie voci del menu\r\n    @Override\r\n    public boolean onOptionsItemSelected(MenuItem item) {\r\n        // Handle item selection\r\n        switch (item.getItemId()) {\r\n            case R.id.help:\r\n                //Aprire sottomenu di help (Ho messo di seguito le voci, forse è uguale)\r\n                return true;\r\n            case R.id.guida:\r\n                /*\r\n                Rimandare alla pagina con la guida/mostrare popup della guida\r\n                Intent intent = new Intent(this, \"guida\".class);\r\n                startActivity(intent);\r\n                 */\r\n                return true;\r\n            case R.id.faq:\r\n                /*\r\n                Rimandare alla pagina con le F.A.Q.\r\n                Intent intent = new Intent(this, \"FAQ\".class);\r\n                startActivity(intent);\r\n                 */\r\n                return true;\r\n            case R.id.contatti:\r\n                /*\r\n                Rimandare alla pagina dei contatti/mostrare popup dei contatti\r\n                Intent intent = new Intent(this, \"contatti\".class);\r\n                startActivity(intent);\r\n                 */\r\n                return true;\r\n            case R.id.credits:\r\n                /*\r\n                Rimandare alla pagina dei credits/mostrare popup dei credits\r\n                Intent intent = new Intent(this, \"credits\".class);\r\n                startActivity(intent);\r\n                 */\r\n                return true;\r\n            case R.id.aggiornamento:\r\n                /*Rimandare alla pagina di aggiornamento\r\n                Intent intent = new Intent(this, \"aggiornamento\".class);\r\n                startActivity(intent);\r\n                */\r\n                return true;\r\n            case R.id.condividi:\r\n                //Copiare il link per la condivisione\r\n                return true;\r\n            case R.id.valuta:\r\n                //Something\r\n                return true;\r\n            case R.id.storico:\r\n                /*Rimandare alla pagina dello storico scansioni/mostrare popup dello storico\r\n                Intent intent = new Intent(this, \"storico\".class);\r\n                startActivity(intent);\r\n                */\r\n                return true;\r\n            case R.id.autoscan:\r\n                //Attivare/disattivare autoscan\r\n                return true;\r\n            case R.id.nascosti:\r\n                /*Rimandare alla pagina dei dispositivi nascosti/mostrare popup dei dispositivi\r\n                Intent intent = new Intent(this, \"nascosti\".class);\r\n                startActivity(intent);\r\n                */\r\n                return true;\r\n\r\n//Opzioni aggiuntive per il metodo 3\r\n            case R.id.favourites:\r\n                //cose\r\n                return true;\r\n            case R.id.stats:\r\n                //cose\r\n                return true;\r\n            case R.id.location:\r\n                //cose\r\n                return true;\r\n            case R.id.history:\r\n                //cose\r\n                return true;\r\n\r\n\r\n            default:\r\n                return super.onOptionsItemSelected(item);\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/test1/MapsActivity.java	(revision 506ffe1df12f1418fc51f1a8de5f3e6bbc0ed8e7)
+++ app/src/main/java/com/example/test1/MapsActivity.java	(date 1607367542007)
@@ -5,26 +5,32 @@
 import androidx.fragment.app.FragmentActivity;
 
 import android.Manifest;
+import android.app.AlertDialog;
+import android.bluetooth.BluetoothAdapter;
+import android.bluetooth.BluetoothDevice;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.content.Intent;
+import android.content.IntentFilter;
 import android.content.pm.PackageManager;
 import android.location.Address;
 import android.location.Geocoder;
 import android.location.Location;
 import android.os.Bundle;
+import android.os.StrictMode;
+import android.provider.Settings;
+import android.util.Log;
 import android.view.Menu;
 import android.view.MenuInflater;
 import android.view.MenuItem;
-import android.view.View;
-import android.widget.Button;
-import android.widget.ImageButton;
+import android.widget.ArrayAdapter;
+import android.widget.LinearLayout;
+import android.widget.ListView;
 import android.widget.SearchView;
 import android.widget.Toast;
 import android.widget.Toolbar;
 
-//Menu inferiore Metodo 2
-//import android.widget.Toolbar.OnMenuItemClickListener;
-//Menu inferiore Metodo 3
-import android.view.MenuItem.OnMenuItemClickListener;
-
 import com.google.android.gms.maps.CameraUpdate;
 import com.google.android.gms.maps.CameraUpdateFactory;
 import com.google.android.gms.maps.GoogleMap;
@@ -37,23 +43,48 @@
 import com.google.android.gms.tasks.OnSuccessListener;
 import com.google.android.gms.tasks.Task;
 
+import org.json.JSONArray;
+import org.json.JSONException;
+import org.json.JSONObject;
+
+import java.io.BufferedReader;
 import java.io.IOException;
+import java.io.InputStreamReader;
+import java.io.OutputStreamWriter;
+import java.net.URL;
+import java.net.URLConnection;
+import java.util.ArrayList;
 import java.util.List;
 
+
+/*v0:
+//aggiunta metodo per fare send e get (get viene fatta come lettura dopo risposta del send per ora poi vediamo)
+//send messa sull click per la posizione per ora
+v1:
+nuovo metodo solo per fare il get senza send creato
+v2:
+messo thread e controllo per permessi prima di fare invio location (location da a (google in california?)
+
+<uses-permission android:name="android.permission.READ_PHONE_STATE" />  per https://stackoverflow.com/questions/29753117/waitinginmainsignalcatcherloop-error-in-android-application
+
+ */
+
+
+/*
+ */
+
 public class MapsActivity extends FragmentActivity implements OnMapReadyCallback, GoogleMap.OnMyLocationButtonClickListener, GoogleMap.OnMyLocationClickListener {
-    private ImageButton bfav;
-    private ImageButton bstats;
-    private ImageButton bloc;
-    private ImageButton bhist;
-
-    private FusedLocationProviderClient fusedLocationClient;
+private FusedLocationProviderClient fusedLocationClient;
     private GoogleMap map;
     SearchView searchView;
+    SupportMapFragment mapFragment;
+
+    //Location location; // Location
+    double latitude; // Latitude
+    double longitude; // Longitude
 
     @Override
     protected void onCreate(Bundle savedInstanceState) {
-
-
         super.onCreate(savedInstanceState);
         setContentView(R.layout.activity_maps);
         fusedLocationClient = LocationServices.getFusedLocationProviderClient(this);
@@ -61,60 +92,15 @@
         //Toolbar superiore con l'overflow menu
         Toolbar myToolbar1 = (Toolbar) findViewById(R.id.toolbar);
         setActionBar(myToolbar1);
-        getActionBar().setDisplayShowTitleEnabled(false);
-
-        //Menu inferiore: Metodo 1
-         //(+)Più semplice degli altri metodi
-         //(+)Si ha tutto in un solo luogo
-         //(-)Quel luogo è la oncreate
-         //(-)I bottoni non compaiono
-/*        ImageButton bfav = findViewById(R.id.imageButtonFavourites);
-        bfav.setOnClickListener(new View.OnClickListener(){
-            public void onClick(View v){
-                //cose
-            }
-        });
-        ImageButton bstats = findViewById(R.id.imageButtonStats);
-        ImageButton bloc = findViewById(R.id.imageButtonLocation);
-        ImageButton bhist = findViewById(R.id.imageButtonHistory);
-*/
-
-
 
-
-        //Menu inferiore: Metodo 2
-         //(+ 0 -?)Permette di avere le azioni al click divise dalle altre
-         //(+)Permette di avere tutte le operazioni in un posto
-         //(-)Quel posto è la oncreate
-         //(-)Non mostra le icone
-        /*
+/*Così come'è non funziona
+        //Toolbarinferiore con il menu a icone/bottoni
         Toolbar myToolbar2 = (Toolbar) findViewById(R.id.toolbar2);
-        myToolbar2.inflateMenu(R.menu.menu_maps_2);
-        myToolbar2.setOnMenuItemClickListener(new OnMenuItemClickListener() {
-            @Override//!!!Con sta roba c'è il secondo menu ma non è con le icone!!!
-            public boolean onMenuItemClick(MenuItem item) {
-                switch (item.getItemId()) {
-                    case R.id.favourites:
-                        //cose
-                        return true;
-                    case R.id.stats:
-                        //cose
-                        return true;
-                    case R.id.location:
-                        //cose
-                        return true;
-                    case R.id.history:
-                        //cose
-                        return true;
-                    default:
-                        return false;
-                }
-            }
-        });*/
-
+        setActionBar( myToolbar2 );
+*/
 
         searchView = findViewById(R.id.srclocation);
-        SupportMapFragment mapFragment = (SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map);
+        mapFragment = (SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map);
 
        searchView.setOnQueryTextListener(new SearchView.OnQueryTextListener() {
             @Override
@@ -152,6 +138,7 @@
 
 
         mapFragment.getMapAsync(this);
+        displayDiscovry(); //scan BLUETOOTH
     }
 
 
@@ -179,6 +166,14 @@
     public void onMyLocationClick(@NonNull Location location) {
         Toast.makeText(this, "Current location:\n" + location, Toast.LENGTH_LONG)
                 .show();
+        //fa la send and il get per ora
+
+        latitude = location.getLatitude();
+        longitude = location.getLongitude();
+
+        //SendLoc(String.format(String.valueOf(location)));
+        controllPermissionAndSend(latitude + ":" + longitude);
+        Log.e("loc","ok=");
     }
 
     @Override
@@ -192,28 +187,13 @@
     //Creazione del menu della maps activity
     @Override
     public boolean onCreateOptionsMenu(Menu menu) {
-        getMenuInflater().inflate(R.menu.menu_maps, menu);
-
-        //Menu inferiore: Metodo 3
-         //(+)Permette di avere la creazione del secondo menu insieme a quella del primo
-         //(+)Permette di aggiungere le opzioni del menu2 a quelle del menu1 per la gestione
-         //(+)Permette di non dover settare i listener nella oncreate
-         //(-)Non mostra le icone come dovrebbe
-        /**/
-        Toolbar myToolbar2 = (Toolbar) findViewById(R.id.toolbar2);
-        Menu menu2 = myToolbar2.getMenu();
-        getMenuInflater().inflate(R.menu.menu_maps_2, menu2);
-        for(int i= 0; i < menu2.size(); i++){
-            menu2.getItem(i).setOnMenuItemClickListener(new OnMenuItemClickListener(){
-                @Override
-                public boolean onMenuItemClick(MenuItem item){
-                    return onOptionsItemSelected(item);
-                }
-            });
-        }
+        MenuInflater inflater = getMenuInflater();
+        inflater.inflate(R.menu.menu_maps, menu);
         return true;
     }
 
+
+
     //Gestione del click sulle varie voci del menu
     @Override
     public boolean onOptionsItemSelected(MenuItem item) {
@@ -223,32 +203,24 @@
                 //Aprire sottomenu di help (Ho messo di seguito le voci, forse è uguale)
                 return true;
             case R.id.guida:
-                /*
-                Rimandare alla pagina con la guida/mostrare popup della guida
-                Intent intent = new Intent(this, "guida".class);
-                startActivity(intent);
-                 */
+                //Rimandare alla pagina con la guida/mostrare popup della guida
+                //Intent intent = new Intent(this, "guida".class);
+                //startActivity(intent);
                 return true;
             case R.id.faq:
-                /*
-                Rimandare alla pagina con le F.A.Q.
-                Intent intent = new Intent(this, "FAQ".class);
-                startActivity(intent);
-                 */
+                //Rimandare alla pagina con le F.A.Q.
+                //Intent intent = new Intent(this, "FAQ".class);
+                //startActivity(intent);
                 return true;
             case R.id.contatti:
-                /*
-                Rimandare alla pagina dei contatti/mostrare popup dei contatti
-                Intent intent = new Intent(this, "contatti".class);
-                startActivity(intent);
-                 */
+                //Rimandare alla pagina dei contatti/mostrare popup dei contatti
+                //Intent intent = new Intent(this, "contatti".class);
+                //startActivity(intent);
                 return true;
             case R.id.credits:
-                /*
-                Rimandare alla pagina dei credits/mostrare popup dei credits
-                Intent intent = new Intent(this, "credits".class);
-                startActivity(intent);
-                 */
+                //Rimandare alla pagina dei credits/mostrare popup dei credits
+                //Intent intent = new Intent(this, "credits".class);
+                //startActivity(intent);
                 return true;
             case R.id.aggiornamento:
                 /*Rimandare alla pagina di aggiornamento
@@ -277,24 +249,268 @@
                 startActivity(intent);
                 */
                 return true;
-
-//Opzioni aggiuntive per il metodo 3
-            case R.id.favourites:
-                //cose
-                return true;
-            case R.id.stats:
-                //cose
-                return true;
-            case R.id.location:
-                //cose
-                return true;
-            case R.id.history:
-                //cose
-                return true;
-
-
             default:
                 return super.onOptionsItemSelected(item);
         }
     }
-}
\ No newline at end of file
+
+    //get info of smartminchia da inviare
+    String getId() {
+        return Settings.Secure.getString(getContentResolver(), Settings.Secure.ANDROID_ID);
+    }
+
+    String getMac() {
+
+        BluetoothAdapter m_BluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
+        return m_BluetoothAdapter.getAddress();
+    }
+    //send and from server php version:
+
+/////////////////////////////////////////////////
+
+    void controllPermissionAndSend(String loc) {
+
+        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
+        StrictMode.setThreadPolicy(policy);
+
+        ArrayList<String> arrayList = new ArrayList<>();
+        if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED && ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
+            // TODO: Consider calling
+            //    ActivityCompat#requestPermissions
+            // here to request the missing permissions, and then overriding
+
+            // to handle the case where the user grants the permission. See the documentation
+            // for ActivityCompat#requestPermissions for more details.
+            arrayList.add(Manifest.permission.ACCESS_FINE_LOCATION);
+            arrayList.add(Manifest.permission.ACCESS_COARSE_LOCATION);
+            Toast.makeText(this, "location fine", Toast.LENGTH_SHORT).show();
+        }else {
+            Log.e("permessi","ok");
+            SendLoc(loc);
+        }
+        if (!arrayList.isEmpty()) {
+            String[] permi = new String[arrayList.size()];
+            permi = arrayList.toArray(permi);
+            ActivityCompat.requestPermissions(this, permi, 0);
+        }
+    }
+
+
+
+
+    //
+
+    public  void  SendLoc(String loc){ //need location
+
+
+
+        String data = "id="+getId()+"&bmac="+getMac()+"&loc="+loc+"&blueFound=0&timeStamp=1";
+
+
+        String text = "";
+        BufferedReader reader=null;
+
+        // Send data
+        Log.e("location","this is your location"+loc);
+        try
+        {
+
+            // Defined URL  where to send data
+            URL url = new URL("http://192.168.0.104/posti.php");
+
+            // Send POST data request
+
+            URLConnection conn = url.openConnection();
+            conn.setDoOutput(true);
+
+            OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
+
+            wr.write( data );
+            wr.flush();
+
+            // Get the server response
+
+            reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));
+            StringBuilder sb = new StringBuilder();
+            String line = null;
+
+            Log.e("loc","ok2 Sent"); //vedi cosa invia
+            // Read Server Response
+            while((line = reader.readLine()) != null)
+            {
+                // Append server response in string
+                sb.append(line + "\n");
+            }
+
+            //server response da usare per i marker nella get
+            text = sb.toString();
+
+        }
+        catch(Exception ex)
+        {
+
+            ex.printStackTrace();
+
+        }
+        finally
+        {
+            try
+            {
+                reader.close();
+            }
+
+            catch(Exception ex) {ex.printStackTrace();}
+            getParsing(text);
+        }
+
+    }
+
+    void getParsing(String k){
+        // get from server and add markers
+
+        try {
+            JSONObject jsonObject = new JSONObject(k);
+
+            JSONArray jsonArray = jsonObject.getJSONArray("data");
+
+            for (int i=0;i<jsonArray.length();i++){
+                final JSONObject obj = jsonArray.getJSONObject(i);
+
+                // Log.e("json",obj.optString("id"));
+                final Double lat= Double.parseDouble(obj.optString("loc").split(":")[0]);
+                final Double lon= Double.parseDouble(obj.optString("loc").split(":")[1]);
+
+                mapFragment.getMapAsync(new OnMapReadyCallback() {
+                    @Override
+                    public void onMapReady(GoogleMap googleMap) {
+                        googleMap.setMapType(GoogleMap.MAP_TYPE_TERRAIN);
+                        googleMap.addMarker(new MarkerOptions()
+                                .position(new LatLng(lat, lon))
+                                .title(obj.optString("id")));
+                        // googleMap.animateCamera(CameraUpdateFactory.newLatLngZoom(new LatLng(37.4233438, -122.0728817), 10));
+                    }
+                });
+            }
+
+        } catch (JSONException e) {
+            e.printStackTrace();
+        }
+    }
+
+    //get separato da send
+    void getLastData(String k){
+
+        String text = "";
+        BufferedReader reader=null;
+
+        try {
+            // Defined URL  where to send data
+            URL url = new URL("http://192.168.1.9/posti.php");
+
+            URLConnection conn = url.openConnection();
+
+            // get from server and add markers
+            reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));
+            StringBuilder sb = new StringBuilder();
+            String line = null;
+
+            // Read Server Response
+            while ((line = reader.readLine()) != null) {
+                // Append server response in string
+                sb.append(line + "\n");
+            }
+
+            //server response da usare per i marker nella get
+            text = sb.toString();
+        }
+        catch(Exception ex)
+        {
+
+            ex.printStackTrace();
+
+        }
+        finally
+        {
+            try
+            {
+                reader.close();
+            }
+
+            catch(Exception ex) {ex.printStackTrace();}
+            getParsing(text);
+        }
+
+
+
+
+    }
+
+    public void  displayDiscovry(){
+
+        final ArrayList<String> list = new ArrayList<>();
+
+        final ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>(MapsActivity.this,android.R.layout.simple_list_item_1,list);
+
+        AlertDialog.Builder alertDialog = new AlertDialog.Builder(MapsActivity.this);
+        LinearLayout linearLayout = new LinearLayout(MapsActivity.this);
+
+        ListView listView = new ListView(MapsActivity.this);
+        linearLayout.addView(listView);
+
+        listView.setAdapter(arrayAdapter);
+
+        final BluetoothAdapter bluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
+        if (bluetoothAdapter == null) {
+            Toast t = new Toast(this);
+            t.setText("Sorry your phone do not support Bluetooth");
+            t.show();
+        } else {
+            if (!bluetoothAdapter.isEnabled()) {
+                Intent enableBtIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
+                startActivityForResult(enableBtIntent,1);}
+            //   bluetoothDev=new BluetoothDev();
+
+            //added
+            // Create a BroadcastReceiver for ACTION_FOUND
+            final BroadcastReceiver mReceiver = new BroadcastReceiver() {
+                public void onReceive(Context context, Intent intent) {
+                    String action = intent.getAction();
+                    // When discovery finds a device
+                    if (BluetoothDevice.ACTION_FOUND.equals(action)) {
+                        // Get the BluetoothDevice object from the Intent
+                        BluetoothDevice device = intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);
+                        // Add the name and address to an array adapter to show in a ListView
+
+                        Log.e("list",device.getAddress());
+                        list.add(device.getName());
+                        arrayAdapter.notifyDataSetChanged();
+
+                    }
+                }
+            };
+// Register the BroadcastReceiver
+            IntentFilter filter = new IntentFilter(BluetoothDevice.ACTION_FOUND);
+            registerReceiver(mReceiver, filter); // Don't forget to unregister during onDestroy
+            //end added
+
+            bluetoothAdapter.startDiscovery();
+
+            alertDialog.setTitle("Bluetooth Scan");
+            alertDialog.setView(linearLayout);
+            alertDialog.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
+                @Override
+                public void onClick(DialogInterface dialog, int which) {
+
+                    unregisterReceiver(mReceiver);
+                    bluetoothAdapter.cancelDiscovery();
+                    dialog.dismiss();
+                }
+            });
+            alertDialog.show();
+
+        }
+    }
+
+}
+
+
Index: app/src/main/res/layout/activity_firstaccess.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"#00BCD4\"\r\n    tools:context=\".FirstAccessActivity\">\r\n\r\n    <com.google.android.material.appbar.AppBarLayout\r\n        android:id=\"@+id/appBarLayout\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:theme=\"@style/AppTheme.AppBarOverlay\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\">\r\n\r\n        <androidx.appcompat.widget.Toolbar\r\n            android:id=\"@+id/toolbar\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"?attr/actionBarSize\"\r\n            android:background=\"?attr/colorPrimary\"\r\n            app:popupTheme=\"@style/AppTheme.PopupOverlay\" />\r\n\r\n    </com.google.android.material.appbar.AppBarLayout>\r\n\r\n    <LinearLayout\r\n        android:layout_width=\"350dp\"\r\n        android:layout_height=\"625dp\"\r\n        android:orientation=\"vertical\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/appBarLayout\">\r\n\r\n        <TextView\r\n            android:id=\"@+id/textViewGuida\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"450dp\"\r\n            android:background=\"#FFFFFF\"\r\n            android:elegantTextHeight=\"true\"\r\n            android:text=\"@string/guida\"\r\n            android:textColor=\"#000000\" />\r\n\r\n        <Space\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"25dp\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/textViewRichiesta\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:background=\"#03A9F4\"\r\n            android:elegantTextHeight=\"true\"\r\n            android:text=\"@string/richiesta_risorse\"\r\n            android:textAlignment=\"center\"\r\n            android:textColor=\"#000000\" />\r\n\r\n        <androidx.constraintlayout.widget.ConstraintLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:background=\"#2196F3\">\r\n\r\n            <Button\r\n                android:id=\"@+id/button\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:backgroundTint=\"#00BCD4\"\r\n                android:text=\"@string/ACCETTA_RISORSEe\"\r\n                android:textAlignment=\"center\"\r\n                android:textAllCaps=\"true\"\r\n                app:layout_constraintBottom_toBottomOf=\"parent\"\r\n                app:layout_constraintEnd_toEndOf=\"parent\"\r\n                app:layout_constraintStart_toStartOf=\"parent\"\r\n                app:layout_constraintTop_toTopOf=\"parent\" />\r\n        </androidx.constraintlayout.widget.ConstraintLayout>\r\n    </LinearLayout>\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_firstaccess.xml	(revision 506ffe1df12f1418fc51f1a8de5f3e6bbc0ed8e7)
+++ app/src/main/res/layout/activity_firstaccess.xml	(date 1607367927299)
@@ -26,18 +26,20 @@
     </com.google.android.material.appbar.AppBarLayout>
 
     <LinearLayout
-        android:layout_width="350dp"
-        android:layout_height="625dp"
+        android:layout_width="309dp"
+        android:layout_height="433dp"
         android:orientation="vertical"
         app:layout_constraintBottom_toBottomOf="parent"
         app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintHorizontal_bias="0.491"
         app:layout_constraintStart_toStartOf="parent"
-        app:layout_constraintTop_toBottomOf="@+id/appBarLayout">
+        app:layout_constraintTop_toBottomOf="@+id/appBarLayout"
+        app:layout_constraintVertical_bias="0.2">
 
         <TextView
             android:id="@+id/textViewGuida"
             android:layout_width="match_parent"
-            android:layout_height="450dp"
+            android:layout_height="258dp"
             android:background="#FFFFFF"
             android:elegantTextHeight="true"
             android:text="@string/guida"
@@ -59,7 +61,7 @@
 
         <androidx.constraintlayout.widget.ConstraintLayout
             android:layout_width="match_parent"
-            android:layout_height="match_parent"
+            android:layout_height="118dp"
             android:background="#2196F3">
 
             <Button
Index: app/src/main/java/com/example/test1/FirstAccessActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.test1;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.RequiresApi;\r\nimport androidx.appcompat.app.AlertDialog;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.app.ActivityCompat;\r\nimport androidx.core.content.ContextCompat;\r\n\r\nimport android.Manifest;\r\nimport android.content.Context;\r\nimport android.content.DialogInterface;\r\nimport android.content.Intent;\r\nimport android.content.pm.PackageManager;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.Toast;\r\n\r\nimport com.google.android.material.snackbar.Snackbar;\r\n\r\npublic class FirstAccessActivity extends AppCompatActivity  {\r\n    public  static final int REQUEST_CODE = 123;\r\n    private Button btaccess;\r\n\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n\r\n        Intent activitymaps = new Intent(FirstAccessActivity.this,MapsActivity.class);\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_firstaccess);\r\n        Button btaccess = findViewById(R.id.button);\r\n\r\n            /*guardo se ho il permesso per il gps, se ce l ho salto direttamente alla maps activity*/\r\n            if (checkPermission(getApplicationContext())){\r\n                startActivity(activitymaps);\r\n            }\r\n            else{\r\n                /** Dangerous permission**/\r\n                btaccess.setOnClickListener(new View.OnClickListener() {\r\n                    @Override\r\n                    public void onClick(View v) {\r\n                        checkRequestpermission();\r\n                    }\r\n                });\r\n            }\r\n\r\n\r\n    }\r\n\r\n\r\n    /*metodo che gestisce il controllo e l' accettazione dei permessi*/\r\n    public void checkRequestpermission() {\r\n        Intent activitymaps = new Intent(FirstAccessActivity.this,MapsActivity.class);\r\n        /*da togliere il primo if, rindondante ----> faccio gia il controllo nella ONcreate*/\r\n\r\n\r\n           if(!checkPermission(FirstAccessActivity.this)) {\r\n                // when permission are not granted\r\n                if (ActivityCompat.shouldShowRequestPermissionRationale(FirstAccessActivity.this, Manifest.permission.ACCESS_FINE_LOCATION)\r\n                    || ActivityCompat.shouldShowRequestPermissionRationale(FirstAccessActivity.this, Manifest.permission.ACCESS_COARSE_LOCATION)) {\r\n\r\n                    AlertDialog.Builder builder = new AlertDialog.Builder(FirstAccessActivity.this);\r\n                    builder.setTitle(\"Grant those permission\");\r\n                    builder.setMessage(\"Read gps location data\");\r\n                    builder.setPositiveButton(\"OK\", new DialogInterface.OnClickListener() {\r\n\r\n                        @Override\r\n                        public void onClick(DialogInterface dialog, int i) {\r\n                            ActivityCompat.requestPermissions(FirstAccessActivity.this,\r\n                                    new String[]{\r\n                                            Manifest.permission.ACCESS_FINE_LOCATION,\r\n                                            Manifest.permission.ACCESS_COARSE_LOCATION\r\n                                    },\r\n                                    REQUEST_CODE);\r\n\r\n                        }\r\n                    });\r\n\r\n                    builder.setNegativeButton(\"cancel\", null);\r\n                    AlertDialog alertDialog = builder.create();\r\n                    alertDialog.show();\r\n                } else {\r\n\r\n                    ActivityCompat.requestPermissions(FirstAccessActivity.this,\r\n                            new String[]{\r\n                                    Manifest.permission.ACCESS_FINE_LOCATION,\r\n                                    Manifest.permission.ACCESS_COARSE_LOCATION\r\n                            },\r\n                            REQUEST_CODE);\r\n                }\r\n                } else {\r\n                    // when permission are already granted\r\n                    Toast.makeText(getApplicationContext(), \"permission already granted\", Toast.LENGTH_SHORT).show();\r\n\r\n\r\n                startActivity(activitymaps);\r\n            }\r\n    }\r\n\r\n\r\n\r\n/* metodo per controllare i permessi*/\r\npublic static boolean checkPermission(Context context){\r\n        return ActivityCompat.checkSelfPermission(context, Manifest.permission.ACCESS_FINE_LOCATION)\r\n                + ActivityCompat.checkSelfPermission(context, Manifest.permission.ACCESS_COARSE_LOCATION) == PackageManager.PERMISSION_GRANTED;\r\n}\r\n\r\n\r\n    /**Dangerous permission**/\r\n    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\r\n        Intent activitymaps = new Intent(FirstAccessActivity.this,MapsActivity.class);\r\n        if(requestCode == REQUEST_CODE){\r\n            if( grantResults.length > 0 && (grantResults[0] + grantResults[1] == PackageManager.PERMISSION_GRANTED)){\r\n                //permission are granted\r\n                Toast.makeText(getApplicationContext(),\"Permission Granted\",Toast.LENGTH_SHORT).show();\r\n\r\n\r\n                startActivity(activitymaps);\r\n            }\r\n            else{\r\n                // permission are denied\r\n                Toast.makeText(getApplicationContext(),\"Permission are denied\",Toast.LENGTH_SHORT).show();\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/test1/FirstAccessActivity.java	(revision 506ffe1df12f1418fc51f1a8de5f3e6bbc0ed8e7)
+++ app/src/main/java/com/example/test1/FirstAccessActivity.java	(date 1607367273924)
@@ -1,5 +1,5 @@
+
 package com.example.test1;
-
 import androidx.annotation.NonNull;
 import androidx.annotation.RequiresApi;
 import androidx.appcompat.app.AlertDialog;
Index: app/src/main/res/layout/activity_maps.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/constraintLayout\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\">\r\n\r\n    <android.widget.Toolbar\r\n        android:id=\"@+id/toolbar\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:background=\"?attr/colorPrimary\"\r\n        android:minHeight=\"?attr/actionBarSize\"\r\n        android:theme=\"?attr/actionBarTheme\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n\r\n    <fragment\r\n        android:id=\"@+id/map\"\r\n        android:name=\"com.google.android.gms.maps.SupportMapFragment\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"0dp\"\r\n        app:layout_constraintBottom_toTopOf=\"@+id/toolbar2\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/toolbar\"\r\n        tools:context=\".MapsActivity\" />\r\n\r\n    <android.widget.Toolbar\r\n        android:id=\"@+id/toolbar2\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:background=\"?attr/colorPrimary\"\r\n        android:minHeight=\"?attr/actionBarSize\"\r\n        android:theme=\"?attr/actionBarTheme\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.0\"\r\n        app:layout_constraintStart_toStartOf=\"parent\" />\r\n\r\n    <ImageButton\r\n        android:id=\"@+id/scanTroieInZona\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginStart=\"176dp\"\r\n        android:layout_marginTop=\"675dp\"\r\n        android:backgroundTint=\"#00FFFFFF\"\r\n        android:tint=\"#FFEB3B\"\r\n        app:layout_constraintBottom_toBottomOf=\"@+id/toolbar2\"\r\n        app:layout_constraintStart_toStartOf=\"@+id/toolbar2\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        app:layout_constraintVertical_bias=\"0.0\"\r\n        app:srcCompat=\"@android:drawable/btn_star\" />\r\n\r\n    <SearchView\r\n        android:id=\"@+id/srclocation\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_margin=\"10dp\"\r\n        android:layout_marginStart=\"16dp\"\r\n        android:layout_marginTop=\"8dp\"\r\n\r\n        android:layout_marginEnd=\"16dp\"\r\n        android:layout_marginBottom=\"8dp\"\r\n        android:background=\"@drawable/src_round\"\r\n        android:elevation=\"5dp\"\r\n        android:iconifiedByDefault=\"false\"\r\n        android:queryHint=\"Search...\"\r\n        app:layout_constraintBottom_toBottomOf=\"@+id/toolbar\"\r\n        app:layout_constraintEnd_toEndOf=\"@+id/toolbar\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"@+id/toolbar\" />\r\n\r\n    <ImageButton\r\n        android:id=\"@+id/imageButtonFavourites\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginStart=\"16dp\"\r\n        android:backgroundTint=\"#00FFFFFF\"\r\n        android:contentDescription=\"@string/favdescription\"\r\n        android:tint=\"#FFEB3B\"\r\n        app:layout_constraintBottom_toBottomOf=\"@+id/toolbar2\"\r\n        app:layout_constraintStart_toStartOf=\"@+id/toolbar2\"\r\n        app:layout_constraintTop_toTopOf=\"@+id/toolbar2\"\r\n        app:srcCompat=\"@android:drawable/btn_star\" />\r\n\r\n    <ImageButton\r\n        android:id=\"@+id/imageButtonStats\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginStart=\"32dp\"\r\n        android:backgroundTint=\"#00FFFFFF\"\r\n        android:contentDescription=\"@string/statdescription\"\r\n        android:tint=\"#000000\"\r\n        app:layout_constraintBottom_toBottomOf=\"@+id/toolbar2\"\r\n        app:layout_constraintStart_toEndOf=\"@id/imageButtonFavourites\"\r\n        app:layout_constraintTop_toTopOf=\"@+id/toolbar2\"\r\n        app:srcCompat=\"@android:drawable/ic_menu_info_details\" />\r\n\r\n    <ImageButton\r\n        android:id=\"@+id/imageButtonLocation\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginEnd=\"32dp\"\r\n        android:backgroundTint=\"#00FFFFFF\"\r\n        android:contentDescription=\"@string/locdescription\"\r\n        android:tint=\"#000000\"\r\n        app:layout_constraintBottom_toBottomOf=\"@+id/toolbar2\"\r\n        app:layout_constraintEnd_toStartOf=\"@id/imageButtonHistory\"\r\n        app:layout_constraintTop_toTopOf=\"@+id/toolbar2\"\r\n        app:srcCompat=\"@android:drawable/ic_menu_myplaces\" />\r\n\r\n    <ImageButton\r\n        android:id=\"@+id/imageButtonHistory\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginEnd=\"16dp\"\r\n        android:backgroundTint=\"#00FFFFFF\"\r\n        android:contentDescription=\"@string/histdescription\"\r\n        android:tint=\"#8FD5F4\"\r\n        app:layout_constraintBottom_toBottomOf=\"@+id/toolbar2\"\r\n        app:layout_constraintEnd_toEndOf=\"@+id/toolbar2\"\r\n        app:layout_constraintTop_toTopOf=\"@+id/toolbar2\"\r\n        app:srcCompat=\"@android:drawable/ic_menu_recent_history\" />\r\n\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_maps.xml	(revision 506ffe1df12f1418fc51f1a8de5f3e6bbc0ed8e7)
+++ app/src/main/res/layout/activity_maps.xml	(date 1607367256648)
@@ -69,6 +69,7 @@
         android:elevation="5dp"
         android:iconifiedByDefault="false"
         android:queryHint="Search..."
+        android:rotationX="8"
         app:layout_constraintBottom_toBottomOf="@+id/toolbar"
         app:layout_constraintEnd_toEndOf="@+id/toolbar"
         app:layout_constraintStart_toStartOf="parent"
Index: app/src/main/AndroidManifest.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    package=\"com.example.test1\">\r\n\r\n    <uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" />\r\n    <uses-permission android:name=\"android.permission.BLUETOOTH_ADMIN\" />\r\n    <uses-permission android:name=\"android.permission.INTERNET\" />\r\n    <uses-permission android:name=\"android.permission.BLUETOOTH\" />\r\n    <uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.READ_PHONE_STATE\" />\r\n\r\n    <application\r\n        android:allowBackup=\"true\"\r\n        android:icon=\"@mipmap/ic_launcher\"\r\n        android:label=\"@string/app_name\"\r\n        android:roundIcon=\"@mipmap/ic_launcher_round\"\r\n        android:supportsRtl=\"true\"\r\n        android:theme=\"@style/AppTheme\">\r\n\r\n        <activity\r\n            android:name=\".SplashActivity\"\r\n            android:theme=\"@style/SplashTheme\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.MAIN\" />\r\n                <category android:name=\"android.intent.category.LAUNCHER\" />\r\n            </intent-filter>\r\n        </activity>\r\n\r\n        <activity android:name=\".FirstAccessActivity\" />\r\n<!--\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.MAIN\" />\r\n                <category android:name=\"android.intent.category.LAUNCHER\" />\r\n            </intent-filter>\r\n        </activity>\r\n-->\r\n\r\n        <activity\r\n            android:name=\".MapsActivity\"\r\n            android:theme=\"@style/AppTheme.NoActionBar\"\r\n            android:label=\"@string/title_activity_maps\" />\r\n\r\n        <meta-data\r\n            android:name=\"com.google.android.geo.API_KEY\"\r\n            android:value=\"@string/google_maps_key\" />\r\n    </application>\r\n\r\n</manifest>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/AndroidManifest.xml	(revision 506ffe1df12f1418fc51f1a8de5f3e6bbc0ed8e7)
+++ app/src/main/AndroidManifest.xml	(date 1607367368599)
@@ -5,6 +5,7 @@
     <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
     <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
     <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />
+    <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />
     <uses-permission android:name="android.permission.INTERNET" />
     <uses-permission android:name="android.permission.BLUETOOTH" />
     <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
